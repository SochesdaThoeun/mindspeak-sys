"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1428],{63464:(a,e,t)=>{t.d(e,{SP:()=>_,Ay:()=>b,bb:()=>u,jA:()=>p,G:()=>y,X0:()=>g,Q1:()=>f,OA:()=>m,_F:()=>C});var n=t(66439);let i={notifications:[],unreadCount:0,pagination:null,filters:{page:1,per_page:15},loading:{fetchNotifications:!1,markAsRead:!1,getUnreadCount:!1},error:null};var o=t(13984);let r=async function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let e=new URLSearchParams;a.page&&e.append("page",a.page.toString()),a.per_page&&e.append("per_page",a.per_page.toString()),void 0!==a.is_read&&e.append("is_read",a.is_read?"true":"false"),a.type&&e.append("type",a.type),a.sort&&e.append("sort",a.sort);let t=e.toString();return(await o.Ay.get("/notifications".concat(t?"?".concat(t):""))).data}catch(a){var e,t,n,i;throw console.error("Get notifications error:",a),{success:!1,message:(null==a||null==(t=a.response)||null==(e=t.data)?void 0:e.message)||"Failed to fetch notifications",errors:null==a||null==(i=a.response)||null==(n=i.data)?void 0:n.errors}}},d=async a=>{try{return(await o.Ay.post("/notifications/read",a)).data}catch(a){var e,t,n,i;throw console.error("Mark notifications as read error:",a),{success:!1,message:(null==a||null==(t=a.response)||null==(e=t.data)?void 0:e.message)||"Failed to mark notifications as read",errors:null==a||null==(i=a.response)||null==(n=i.data)?void 0:n.errors}}},s=async()=>{try{return{unread_count:(await r({page:1,per_page:1,is_read:!1})).meta.unread_count}}catch(i){var a,e,t,n;throw console.error("Get unread count error:",i),{success:!1,message:(null==i||null==(e=i.response)||null==(a=e.data)?void 0:a.message)||"Failed to get unread count",errors:null==i||null==(n=i.response)||null==(t=n.data)?void 0:t.errors}}},l=async()=>{try{return await d({mark_all:!0})}catch(a){throw console.error("Mark all notifications as read error:",a),a}},c=async a=>{try{return await d({notification_ids:a})}catch(a){throw console.error("Mark specific notifications as read error:",a),a}},u=(0,n.zD)("notifications/fetchNotifications",async function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{rejectWithValue:e}=arguments.length>1?arguments[1]:void 0;try{return await r(a)}catch(a){return e((null==a?void 0:a.message)||"Failed to fetch notifications")}}),f=(0,n.zD)("notifications/markAsRead",async(a,e)=>{let{rejectWithValue:t}=e;try{return{...await d(a),payload:a}}catch(a){return t((null==a?void 0:a.message)||"Failed to mark notifications as read")}}),p=(0,n.zD)("notifications/fetchUnreadCount",async(a,e)=>{let{rejectWithValue:t}=e;try{return await s()}catch(a){return t((null==a?void 0:a.message)||"Failed to fetch unread count")}}),g=(0,n.zD)("notifications/markAllAsRead",async(a,e)=>{let{rejectWithValue:t}=e;try{return await l()}catch(a){return t((null==a?void 0:a.message)||"Failed to mark all notifications as read")}}),m=(0,n.zD)("notifications/markSpecificAsRead",async(a,e)=>{let{rejectWithValue:t}=e;try{return{...await c(a),notificationIds:a}}catch(a){return t((null==a?void 0:a.message)||"Failed to mark specific notifications as read")}}),y=(0,n.zD)("notifications/loadMore",async(a,e)=>{let{rejectWithValue:t,getState:n}=e;try{var i;let e=(null==(i=n().notifications.pagination)?void 0:i.current_page)||1;return await r({...a,page:e+1})}catch(a){return t((null==a?void 0:a.message)||"Failed to load more notifications")}}),h=(0,n.Z0)({name:"notifications",initialState:i,reducers:{setFilters:(a,e)=>{a.filters={...a.filters,...e.payload},(void 0!==e.payload.is_read||void 0!==e.payload.type)&&(a.filters.page=1)},clearNotifications:a=>{a.notifications=[],a.pagination=null,a.error=null},clearError:a=>{a.error=null},resetState:()=>i,updateLocalReadStatus:(a,e)=>{let{notification_ids:t,is_read:n}=e.payload;if(a.notifications)if(a.notifications=a.notifications.map(a=>t.includes(a.id)?{...a,is_read:n}:a),n){let e=t.filter(e=>a.notifications.find(a=>a.id===e&&!a.is_read)).length;a.unreadCount=Math.max(0,a.unreadCount-e)}else{let e=t.filter(e=>a.notifications.find(a=>a.id===e&&a.is_read)).length;a.unreadCount+=e}}},extraReducers:a=>{a.addCase(u.pending,a=>{a.loading.fetchNotifications=!0,a.error=null}).addCase(u.fulfilled,(a,e)=>{a.loading.fetchNotifications=!1,a.notifications=e.payload.data,a.pagination=e.payload.meta.pagination,a.unreadCount=e.payload.meta.unread_count}).addCase(u.rejected,(a,e)=>{a.loading.fetchNotifications=!1,a.error=e.payload}),a.addCase(y.pending,a=>{a.loading.fetchNotifications=!0,a.error=null}).addCase(y.fulfilled,(a,e)=>{a.loading.fetchNotifications=!1,a.notifications=[...a.notifications||[],...e.payload.data],a.pagination=e.payload.meta.pagination,a.unreadCount=e.payload.meta.unread_count}).addCase(y.rejected,(a,e)=>{a.loading.fetchNotifications=!1,a.error=e.payload}),a.addCase(f.pending,a=>{a.loading.markAsRead=!0,a.error=null}).addCase(f.fulfilled,(a,e)=>{if(a.loading.markAsRead=!1,a.unreadCount=e.payload.data.unread_count,a.notifications){let{payload:t}=e.payload;t.mark_all?a.notifications=a.notifications.map(a=>({...a,is_read:!0})):t.notification_ids&&(a.notifications=a.notifications.map(a=>t.notification_ids.includes(a.id)?{...a,is_read:!0}:a))}}).addCase(f.rejected,(a,e)=>{a.loading.markAsRead=!1,a.error=e.payload}),a.addCase(p.pending,a=>{a.loading.getUnreadCount=!0}).addCase(p.fulfilled,(a,e)=>{a.loading.getUnreadCount=!1,a.unreadCount=e.payload.unread_count}).addCase(p.rejected,(a,e)=>{a.loading.getUnreadCount=!1,a.error=e.payload}),a.addCase(g.pending,a=>{a.loading.markAsRead=!0,a.error=null}).addCase(g.fulfilled,(a,e)=>{a.loading.markAsRead=!1,a.unreadCount=e.payload.data.unread_count,a.notifications&&(a.notifications=a.notifications.map(a=>({...a,is_read:!0})))}).addCase(g.rejected,(a,e)=>{a.loading.markAsRead=!1,a.error=e.payload}),a.addCase(m.pending,a=>{a.loading.markAsRead=!0,a.error=null}).addCase(m.fulfilled,(a,e)=>{a.loading.markAsRead=!1,a.unreadCount=e.payload.data.unread_count,a.notifications&&(a.notifications=a.notifications.map(a=>e.payload.notificationIds.includes(a.id)?{...a,is_read:!0}:a))}).addCase(m.rejected,(a,e)=>{a.loading.markAsRead=!1,a.error=e.payload})}}),{setFilters:C,clearNotifications:_,clearError:k,resetState:v,updateLocalReadStatus:w}=h.actions,b=h.reducer},80333:(a,e,t)=>{t.d(e,{d:()=>d});var n=t(95155),i=t(12115),o=t(4884),r=t(59434);let d=i.forwardRef((a,e)=>{let{className:t,...i}=a;return(0,n.jsx)(o.bL,{className:(0,r.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...i,ref:e,children:(0,n.jsx)(o.zi,{className:(0,r.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});d.displayName=o.bL.displayName},85057:(a,e,t)=>{t.d(e,{J:()=>l});var n=t(95155),i=t(12115),o=t(40968),r=t(74466),d=t(59434);let s=(0,r.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=i.forwardRef((a,e)=>{let{className:t,...i}=a;return(0,n.jsx)(o.b,{ref:e,className:(0,d.cn)(s(),t),...i})});l.displayName=o.b.displayName}}]);