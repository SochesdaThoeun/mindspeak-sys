(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6954],{6398:(e,s,a)=>{Promise.resolve().then(a.bind(a,6955))},6955:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>S});var t=a(95155),r=a(12115),l=a(35695),n=a(66695),c=a(91394),i=a(30285),d=a(35169),o=a(5623),x=a(51976),m=a(71366),h=a(66516),g=a(62108),u=a(44838),j=a(59434),p=a(66766),y=a(62523);let v=(0,a(19946).A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var N=a(62525),k=a(12486),f=a(88539),b=a(53680),w=a(97953);function _(e){let{postId:s,isExpanded:a,onToggleExpand:l,onAddComment:n,onEditComment:d,onDeleteComment:x,formatTimestamp:m}=e,h=(0,b.jL)(),{comments:g,isLoading:j}=(0,b.a4)(parseInt(s)),[p,_]=(0,r.useState)(""),[C,A]=(0,r.useState)(null),[S,I]=(0,r.useState)(""),[$,E]=(0,r.useState)(!1),[z,L]=(0,r.useState)(!1),T=(0,r.useRef)(null),F=(0,r.useRef)(null);(0,r.useEffect)(()=>{a&&!z?(L(!0),h((0,b.rq)({postId:parseInt(s)}))):a||L(!1)},[h,s,a,z]),(0,r.useEffect)(()=>{C&&F.current&&F.current.focus()},[C]);let B=async()=>{if(p.trim()&&!$){E(!0);try{await n(parseInt(s),p),_("")}catch(e){console.error("Failed to add comment:",e)}finally{E(!1)}}},R=e=>{A(e.id),I(e.content)},M=()=>{A(null),I("")},P=e=>{S.trim()&&(d(s,e.toString(),S),A(null))};return(0,t.jsx)("div",{className:"border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:(0,t.jsxs)("div",{className:"px-4 py-3",children:[(0,t.jsx)("h3",{className:"text-base font-medium mb-3",children:"Comments"}),(0,t.jsx)("div",{className:"space-y-4",children:j&&0===g.length?(0,t.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"Loading comments..."})}):(0,t.jsxs)(t.Fragment,{children:[g.slice(0,a?void 0:2).map(e=>(0,t.jsx)("div",{className:"animate-fadeIn",children:(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsxs)(c.eu,{className:"h-10 w-10 flex-shrink-0",children:[(0,t.jsx)(c.BK,{src:e.author_avatar||w.A.src,alt:e.author_name}),(0,t.jsx)(c.q5,{children:e.author_name.charAt(0)})]}),(0,t.jsx)("div",{className:"flex-1",children:C===e.id?(0,t.jsxs)("div",{className:"space-y-2 animate-fadeIn",children:[(0,t.jsx)(f.T,{ref:F,value:S,onChange:e=>I(e.target.value),className:"min-h-[60px] text-sm"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(i.$,{size:"sm",onClick:()=>P(e.id),children:"Save"}),(0,t.jsx)(i.$,{size:"sm",variant:"outline",onClick:M,children:"Cancel"})]})]}):(0,t.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"font-medium text-sm",children:e.author_name}),(0,t.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:m(e.created_at)})]}),e.can_edit&&(0,t.jsxs)(u.rI,{children:[(0,t.jsx)(u.ty,{asChild:!0,children:(0,t.jsxs)(i.$,{variant:"ghost",size:"icon",className:"h-6 w-6 rounded-full",children:[(0,t.jsx)(o.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"More options"})]})}),(0,t.jsxs)(u.SQ,{align:"end",children:[(0,t.jsxs)(u._2,{onClick:()=>R(e),children:[(0,t.jsx)(v,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.can_delete&&(0,t.jsxs)(u._2,{onClick:()=>x(s,e.id.toString()),className:"text-red-600",children:[(0,t.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-900 dark:text-gray-100",children:e.content})]})})]})},e.id)),g.length>2&&!a&&(0,t.jsxs)(i.$,{variant:"ghost",onClick:l,className:"text-sm text-gray-500 hover:text-gray-700",children:["View ",g.length-2," more comments"]}),a&&g.length>2&&(0,t.jsx)(i.$,{variant:"ghost",onClick:l,className:"text-sm text-gray-500 hover:text-gray-700",children:"Show less"})]})}),(0,t.jsxs)("div",{className:"mt-4 flex space-x-3",children:[(0,t.jsxs)(c.eu,{className:"h-8 w-8 flex-shrink-0",children:[(0,t.jsx)(c.BK,{src:w.A.src,alt:"You"}),(0,t.jsx)(c.q5,{children:"U"})]}),(0,t.jsxs)("div",{className:"flex-1 flex space-x-2",children:[(0,t.jsx)(y.p,{ref:T,placeholder:"Write a comment...",value:p,onChange:e=>_(e.target.value),onKeyPress:e=>"Enter"===e.key&&B(),className:"flex-1",disabled:$}),(0,t.jsx)(i.$,{size:"sm",onClick:B,disabled:!p.trim()||$,children:(0,t.jsx)(k.A,{className:"h-4 w-4"})})]})]})]})})}var C=a(12840),A=a(28052);function S(){let e=(0,l.useParams)(),s=(0,l.useRouter)(),a=(0,b.jL)(),{currentPost:y,isLoading:v,error:N}=(0,b.j6)(),k=parseInt(e.postId),[f,S]=(0,r.useState)(!1),[I,$]=(0,r.useState)(null);(0,r.useEffect)(()=>{k&&(a((0,C.tY)(k)),a((0,A.rq)({postId:k})))},[a,k]);let E=e=>{let s=new Date(e),a=Math.floor((new Date().getTime()-s.getTime())/6e4);return a<1?"Just now":a<60?"".concat(a,"m ago"):a<1440?"".concat(Math.floor(a/60),"h ago"):"".concat(Math.floor(a/1440),"d ago")},z=async()=>{if(y){$(null);try{let e=y.is_liked_by_user||!1;console.log("\uD83D\uDD04 Toggle Like on Single Post:",{postId:y.id,currentLikedStatus:e,currentLikeCount:y.like_count});let s=e?await a((0,C.Rn)(y.id)).unwrap():await a((0,C.kL)(y.id)).unwrap();console.log("✅ Toggle Like Result:",s),await a((0,C.tY)(k))}catch(e){console.error("Failed to toggle like:",e),$("Failed to toggle like. Please try again."),setTimeout(()=>$(null),3e3)}}},L=()=>{S(!f),console.log("Bookmark functionality not yet implemented")},T=()=>{let e=window.location.href;navigator.share?navigator.share({title:(null==y?void 0:y.title)||"Check out this post",text:(null==y?void 0:y.content)||"Interesting post from our social feed",url:e}).catch(console.error):navigator.clipboard.writeText(e).then(()=>{alert("Link copied to clipboard!")}).catch(()=>{alert("Failed to copy link")})},F=async(e,s)=>{try{await a((0,A.eT)({postId:e,payload:{content:s,is_anonymous:!0}})).unwrap(),a((0,A.rq)({postId:e}))}catch(e){console.error("Failed to add comment:",e)}};return v?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-6"}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),(0,t.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})]})})}):N||!y?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[(0,t.jsxs)(i.$,{variant:"ghost",onClick:()=>s.back(),className:"mb-4",children:[(0,t.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Back to Feed"]}),(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("p",{className:"text-red-500 text-lg mb-4",children:N||"Post not found"}),(0,t.jsx)(i.$,{onClick:()=>s.push("/user-dashboard/feed"),children:"Return to Feed"})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[(0,t.jsxs)(i.$,{variant:"ghost",onClick:()=>s.back(),className:"mb-4 bg-[#1d2b7d] text-white hover:bg-white hover:text-[#1d2b7d] shadow-md shadow-gray-800/80 hover:shadow-md hover:shadow-[#1d2b7d]",children:[(0,t.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Back to Feed"]}),(0,t.jsxs)(n.Zp,{className:"shadow-sm border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 overflow-hidden",children:[(0,t.jsxs)(n.aR,{className:"flex flex-row items-start p-6 space-y-0",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-3 flex-1",children:[(0,t.jsxs)(c.eu,{className:"h-12 w-12",children:[(0,t.jsx)(c.BK,{src:y.author_avatar||w.A.src,alt:y.author||"Anonymous"}),(0,t.jsx)(c.q5,{children:(y.author||"A").charAt(0)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("span",{className:"font-semibold text-lg",children:y.author||"Anonymous"})}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 flex items-center",children:[(0,t.jsxs)("span",{children:["@",y.is_anonymous?"anonymous":"user"]}),(0,t.jsx)("span",{className:"mx-1",children:"•"}),(0,t.jsx)("span",{children:E(y.created_at)})]})]})]}),(0,t.jsxs)(u.rI,{children:[(0,t.jsx)(u.ty,{asChild:!0,children:(0,t.jsxs)(i.$,{variant:"ghost",size:"icon",className:"rounded-full h-8 w-8",children:[(0,t.jsx)(o.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"sr-only",children:"More options"})]})}),(0,t.jsxs)(u.SQ,{align:"end",children:[(0,t.jsx)(u._2,{onClick:T,children:"Share"}),(0,t.jsx)(u._2,{onClick:L,children:f?"Remove Bookmark":"Bookmark"})]})]})]}),(0,t.jsxs)(n.Wu,{className:"p-0",children:[y.content&&(0,t.jsx)("div",{className:"px-6 py-4 text-lg leading-relaxed",children:y.content}),y.tags&&y.tags.length>0&&(0,t.jsx)("div",{className:"px-6 pb-4 flex flex-wrap gap-2",children:y.tags.map((e,s)=>(0,t.jsxs)("span",{className:"text-blue-500 hover:underline cursor-pointer text-sm",children:["#",e]},s))}),y.image&&y.image.url&&(0,t.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800",children:(0,t.jsx)(p.default,{src:y.image.url,alt:y.image.alt_text||"Post content",width:800,height:600,className:"w-full object-cover max-h-[600px]"})}),I&&(0,t.jsx)("div",{className:"px-6 py-2 text-sm text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-400",children:I}),(0,t.jsxs)("div",{className:"px-6 py-4 flex items-center justify-between border-t border-gray-100 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,t.jsxs)(i.$,{variant:"ghost",size:"sm",className:(0,j.cn)("flex items-center space-x-2 px-3 transition-colors duration-200",y.is_liked_by_user?"text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20":"text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20"),onClick:z,children:[(0,t.jsx)(x.A,{className:(0,j.cn)("h-5 w-5 transition-all duration-200","hover:scale-110"),fill:y.is_liked_by_user?"currentColor":"none"}),(0,t.jsx)("span",{className:"font-medium",children:y.like_count})]},"like-btn-".concat(y.id,"-").concat(y.is_liked_by_user,"-").concat(y.like_count)),(0,t.jsxs)("div",{className:"flex items-center space-x-2 px-3 text-gray-600 dark:text-gray-400",children:[(0,t.jsx)(m.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:y.comment_count})]}),(0,t.jsxs)(i.$,{variant:"ghost",size:"sm",className:"flex items-center space-x-2 px-3 text-gray-600 dark:text-gray-400",onClick:T,children:[(0,t.jsx)(h.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Share"})]})]}),(0,t.jsx)(i.$,{variant:"ghost",size:"sm",className:(0,j.cn)("px-3",f?"text-blue-500":"text-gray-600 dark:text-gray-400"),onClick:L,children:(0,t.jsx)(g.A,{className:(0,j.cn)("h-5 w-5 transition-transform",f&&"fill-current")})})]}),(0,t.jsx)(_,{postId:y.id.toString(),isExpanded:!0,onToggleExpand:()=>{},onAddComment:F,onEditComment:()=>{console.log("Edit comment not yet implemented")},onDeleteComment:()=>{console.log("Delete comment not yet implemented")},formatTimestamp:E})]})]})]})})}},35169:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[7598,3863,6766,3024,2043,9267,1118,8185,7224,14,8441,1684,7358],()=>s(6398)),_N_E=e.O()}]);