(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{10492:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>m,Cj:()=>c,_F:()=>f});var o=t(66439);let i={faqs:[],adminFaqs:[],pagination:null,filters:{page:1,per_page:15},loading:{fetchFaqs:!1,createFaq:!1,updateFaq:!1,deleteFaq:!1},error:null};var l=t(13984);let r=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let a=new URLSearchParams;e.search&&a.append("search",e.search),e.page&&a.append("page",e.page.toString()),e.per_page&&a.append("per_page",e.per_page.toString());let t=a.toString();return(await l.Ay.get("/faqs".concat(t?"?".concat(t):""))).data}catch(e){var a,t,o,i;throw console.error("Get FAQs error:",e),{success:!1,message:(null==e||null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to fetch FAQs",errors:null==e||null==(i=e.response)||null==(o=i.data)?void 0:o.errors}}},s=async e=>{try{return(await l.Ay.post("/faqs",e)).data}catch(e){var a,t,o,i;throw console.error("Create FAQ error:",e),{success:!1,message:(null==e||null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to create FAQ",errors:null==e||null==(i=e.response)||null==(o=i.data)?void 0:o.errors}}},n=async e=>{try{let{faqId:a,...t}=e;return(await l.Ay.put("/faqs/".concat(a),t)).data}catch(e){var a,t,o,i;throw console.error("Update FAQ error:",e),{success:!1,message:(null==e||null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to update FAQ",errors:null==e||null==(i=e.response)||null==(o=i.data)?void 0:o.errors}}},d=async e=>{try{return(await l.Ay.delete("/faqs/".concat(e))).data}catch(e){var a,t,o,i;throw console.error("Delete FAQ error:",e),{success:!1,message:(null==e||null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to delete FAQ",errors:null==e||null==(i=e.response)||null==(o=i.data)?void 0:o.errors}}},c=(0,o.zD)("faqs/fetchFaqs",async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{rejectWithValue:a}=arguments.length>1?arguments[1]:void 0;try{return await r(e)}catch(e){return a((null==e?void 0:e.message)||"Failed to fetch FAQs")}}),u=(0,o.zD)("faqs/createFaq",async(e,a)=>{let{rejectWithValue:t}=a;try{return await s(e)}catch(e){return t((null==e?void 0:e.message)||"Failed to create FAQ")}}),g=(0,o.zD)("faqs/updateFaq",async(e,a)=>{let{rejectWithValue:t}=a;try{return await n(e)}catch(e){return t((null==e?void 0:e.message)||"Failed to update FAQ")}}),p=(0,o.zD)("faqs/deleteFaq",async(e,a)=>{let{rejectWithValue:t}=a;try{return{...await d(e),faqId:e}}catch(e){return t((null==e?void 0:e.message)||"Failed to delete FAQ")}}),k=(0,o.Z0)({name:"faqs",initialState:i,reducers:{setFilters:(e,a)=>{e.filters={...e.filters,...a.payload}},clearFaqs:e=>{e.faqs=[],e.adminFaqs=[],e.pagination=null,e.error=null},clearError:e=>{e.error=null},resetState:()=>i},extraReducers:e=>{e.addCase(c.pending,e=>{e.loading.fetchFaqs=!0,e.error=null}).addCase(c.fulfilled,(e,a)=>{e.loading.fetchFaqs=!1,e.faqs=a.payload.data.data,e.adminFaqs=a.payload.data.data,e.pagination={current_page:a.payload.data.current_page,last_page:a.payload.data.last_page,per_page:a.payload.data.per_page,total:a.payload.data.total,from:a.payload.data.from,to:a.payload.data.to,first_page_url:a.payload.data.first_page_url,last_page_url:a.payload.data.last_page_url,next_page_url:a.payload.data.next_page_url,prev_page_url:a.payload.data.prev_page_url,path:a.payload.data.path,links:a.payload.data.links}}).addCase(c.rejected,(e,a)=>{e.loading.fetchFaqs=!1,e.error=a.payload}),e.addCase(u.pending,e=>{e.loading.createFaq=!0,e.error=null}).addCase(u.fulfilled,(e,a)=>{e.loading.createFaq=!1;let t=a.payload.data;e.faqs=[t,...e.faqs],e.adminFaqs=[t,...e.adminFaqs]}).addCase(u.rejected,(e,a)=>{e.loading.createFaq=!1,e.error=a.payload}),e.addCase(g.pending,e=>{e.loading.updateFaq=!0,e.error=null}).addCase(g.fulfilled,(e,a)=>{e.loading.updateFaq=!1;let t=a.payload.data,o=e.faqs.findIndex(e=>e.id===t.id);-1!==o&&(e.faqs[o]=t);let i=e.adminFaqs.findIndex(e=>e.id===t.id);-1!==i&&(e.adminFaqs[i]=t)}).addCase(g.rejected,(e,a)=>{e.loading.updateFaq=!1,e.error=a.payload}),e.addCase(p.pending,e=>{e.loading.deleteFaq=!0,e.error=null}).addCase(p.fulfilled,(e,a)=>{e.loading.deleteFaq=!1;let{faqId:t}=a.payload;e.faqs=e.faqs.filter(e=>e.id!==t),e.adminFaqs=e.adminFaqs.filter(e=>e.id!==t)}).addCase(p.rejected,(e,a)=>{e.loading.deleteFaq=!1,e.error=a.payload})}}),{setFilters:f,clearFaqs:y,clearError:h,resetState:_}=k.actions,m=k.reducer},29750:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,30347,23)),Promise.resolve().then(t.bind(t,68650))},30347:()=>{},63464:(e,a,t)=>{"use strict";t.d(a,{SP:()=>m,Ay:()=>L,bb:()=>u,jA:()=>p,G:()=>y,X0:()=>k,Q1:()=>g,OA:()=>f,_F:()=>_});var o=t(66439);let i={notifications:[],unreadCount:0,pagination:null,filters:{page:1,per_page:15},loading:{fetchNotifications:!1,markAsRead:!1,getUnreadCount:!1},error:null};var l=t(13984);let r=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let a=new URLSearchParams;e.page&&a.append("page",e.page.toString()),e.per_page&&a.append("per_page",e.per_page.toString()),void 0!==e.is_read&&a.append("is_read",e.is_read?"true":"false"),e.type&&a.append("type",e.type),e.sort&&a.append("sort",e.sort);let t=a.toString();return(await l.Ay.get("/notifications".concat(t?"?".concat(t):""))).data}catch(e){var a,t,o,i;throw console.error("Get notifications error:",e),{success:!1,message:(null==e||null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to fetch notifications",errors:null==e||null==(i=e.response)||null==(o=i.data)?void 0:o.errors}}},s=async e=>{try{return(await l.Ay.post("/notifications/read",e)).data}catch(e){var a,t,o,i;throw console.error("Mark notifications as read error:",e),{success:!1,message:(null==e||null==(t=e.response)||null==(a=t.data)?void 0:a.message)||"Failed to mark notifications as read",errors:null==e||null==(i=e.response)||null==(o=i.data)?void 0:o.errors}}},n=async()=>{try{return{unread_count:(await r({page:1,per_page:1,is_read:!1})).meta.unread_count}}catch(i){var e,a,t,o;throw console.error("Get unread count error:",i),{success:!1,message:(null==i||null==(a=i.response)||null==(e=a.data)?void 0:e.message)||"Failed to get unread count",errors:null==i||null==(o=i.response)||null==(t=o.data)?void 0:t.errors}}},d=async()=>{try{return await s({mark_all:!0})}catch(e){throw console.error("Mark all notifications as read error:",e),e}},c=async e=>{try{return await s({notification_ids:e})}catch(e){throw console.error("Mark specific notifications as read error:",e),e}},u=(0,o.zD)("notifications/fetchNotifications",async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{rejectWithValue:a}=arguments.length>1?arguments[1]:void 0;try{return await r(e)}catch(e){return a((null==e?void 0:e.message)||"Failed to fetch notifications")}}),g=(0,o.zD)("notifications/markAsRead",async(e,a)=>{let{rejectWithValue:t}=a;try{return{...await s(e),payload:e}}catch(e){return t((null==e?void 0:e.message)||"Failed to mark notifications as read")}}),p=(0,o.zD)("notifications/fetchUnreadCount",async(e,a)=>{let{rejectWithValue:t}=a;try{return await n()}catch(e){return t((null==e?void 0:e.message)||"Failed to fetch unread count")}}),k=(0,o.zD)("notifications/markAllAsRead",async(e,a)=>{let{rejectWithValue:t}=a;try{return await d()}catch(e){return t((null==e?void 0:e.message)||"Failed to mark all notifications as read")}}),f=(0,o.zD)("notifications/markSpecificAsRead",async(e,a)=>{let{rejectWithValue:t}=a;try{return{...await c(e),notificationIds:e}}catch(e){return t((null==e?void 0:e.message)||"Failed to mark specific notifications as read")}}),y=(0,o.zD)("notifications/loadMore",async(e,a)=>{let{rejectWithValue:t,getState:o}=a;try{var i;let a=(null==(i=o().notifications.pagination)?void 0:i.current_page)||1;return await r({...e,page:a+1})}catch(e){return t((null==e?void 0:e.message)||"Failed to load more notifications")}}),h=(0,o.Z0)({name:"notifications",initialState:i,reducers:{setFilters:(e,a)=>{e.filters={...e.filters,...a.payload},(void 0!==a.payload.is_read||void 0!==a.payload.type)&&(e.filters.page=1)},clearNotifications:e=>{e.notifications=[],e.pagination=null,e.error=null},clearError:e=>{e.error=null},resetState:()=>i,updateLocalReadStatus:(e,a)=>{let{notification_ids:t,is_read:o}=a.payload;if(e.notifications)if(e.notifications=e.notifications.map(e=>t.includes(e.id)?{...e,is_read:o}:e),o){let a=t.filter(a=>e.notifications.find(e=>e.id===a&&!e.is_read)).length;e.unreadCount=Math.max(0,e.unreadCount-a)}else{let a=t.filter(a=>e.notifications.find(e=>e.id===a&&e.is_read)).length;e.unreadCount+=a}}},extraReducers:e=>{e.addCase(u.pending,e=>{e.loading.fetchNotifications=!0,e.error=null}).addCase(u.fulfilled,(e,a)=>{e.loading.fetchNotifications=!1,e.notifications=a.payload.data,e.pagination=a.payload.meta.pagination,e.unreadCount=a.payload.meta.unread_count}).addCase(u.rejected,(e,a)=>{e.loading.fetchNotifications=!1,e.error=a.payload}),e.addCase(y.pending,e=>{e.loading.fetchNotifications=!0,e.error=null}).addCase(y.fulfilled,(e,a)=>{e.loading.fetchNotifications=!1,e.notifications=[...e.notifications||[],...a.payload.data],e.pagination=a.payload.meta.pagination,e.unreadCount=a.payload.meta.unread_count}).addCase(y.rejected,(e,a)=>{e.loading.fetchNotifications=!1,e.error=a.payload}),e.addCase(g.pending,e=>{e.loading.markAsRead=!0,e.error=null}).addCase(g.fulfilled,(e,a)=>{if(e.loading.markAsRead=!1,e.unreadCount=a.payload.data.unread_count,e.notifications){let{payload:t}=a.payload;t.mark_all?e.notifications=e.notifications.map(e=>({...e,is_read:!0})):t.notification_ids&&(e.notifications=e.notifications.map(e=>t.notification_ids.includes(e.id)?{...e,is_read:!0}:e))}}).addCase(g.rejected,(e,a)=>{e.loading.markAsRead=!1,e.error=a.payload}),e.addCase(p.pending,e=>{e.loading.getUnreadCount=!0}).addCase(p.fulfilled,(e,a)=>{e.loading.getUnreadCount=!1,e.unreadCount=a.payload.unread_count}).addCase(p.rejected,(e,a)=>{e.loading.getUnreadCount=!1,e.error=a.payload}),e.addCase(k.pending,e=>{e.loading.markAsRead=!0,e.error=null}).addCase(k.fulfilled,(e,a)=>{e.loading.markAsRead=!1,e.unreadCount=a.payload.data.unread_count,e.notifications&&(e.notifications=e.notifications.map(e=>({...e,is_read:!0})))}).addCase(k.rejected,(e,a)=>{e.loading.markAsRead=!1,e.error=a.payload}),e.addCase(f.pending,e=>{e.loading.markAsRead=!0,e.error=null}).addCase(f.fulfilled,(e,a)=>{e.loading.markAsRead=!1,e.unreadCount=a.payload.data.unread_count,e.notifications&&(e.notifications=e.notifications.map(e=>a.payload.notificationIds.includes(e.id)?{...e,is_read:!0}:e))}).addCase(f.rejected,(e,a)=>{e.loading.markAsRead=!1,e.error=a.payload})}}),{setFilters:_,clearNotifications:m,clearError:v,resetState:F,updateLocalReadStatus:C}=h.actions,L=h.reducer},68650:(e,a,t)=>{"use strict";t.d(a,{StoreProvider:()=>D});var o=t(95155),i=t(12115),l=t(34540),r=t(97730),s=t(66439),n=t(61328),d=t(18091),c=t(52),u=t(54287),g=t(12840),p=t(28052),k=t(63464),f=t(16860),y=t(10492),h=t(76048),_=t(41480),m=t(13984);let v={async getPostLikes(e){let{postId:a}=e;console.log("\uD83D\uDCE1 Like Service: Getting likes for post:",a);try{let e=await m.FH.get("/posts/".concat(a,"/likes"));return console.log("✅ Like Service: Got post likes successfully:",{postId:a,likeCount:e.data.data.like_count,likesCount:e.data.data.likes.length,userHasLiked:e.data.data.user_has_liked}),e.data}catch(e){var t;throw console.error("❌ Like Service: Failed to get post likes:",{postId:a,error:(null==(t=e.response)?void 0:t.data)||e.message}),e}},async likePost(e){var a,t,o,i,l,r,s;let{postId:n}=e;console.log("\uD83D\uDCE1 Like Service: Liking post:",n);try{let e=await m.FH.post("/posts/".concat(n,"/like"));return console.log("✅ Like Service: Liked post successfully:",{postId:n,likeCount:null==(a=e.data.data)?void 0:a.like_count,userHasLiked:null==(t=e.data.data)?void 0:t.user_has_liked}),e.data}catch(e){throw console.error("❌ Like Service: Failed to like post:",{postId:n,error:(null==(o=e.response)?void 0:o.data)||e.message}),(null==(i=e.response)?void 0:i.status)===400&&(null==(s=e.response)||null==(r=s.data)||null==(l=r.message)?void 0:l.includes("already liked"))&&console.warn("⚠️ Like Service: Post already liked by user"),e}},async unlikePost(e){var a,t,o,i,l,r,s;let{postId:n}=e;console.log("\uD83D\uDCE1 Like Service: Unliking post:",n);try{let e=await m.FH.post("/posts/".concat(n,"/unlike"));return console.log("✅ Like Service: Unliked post successfully:",{postId:n,likeCount:null==(a=e.data.data)?void 0:a.like_count,userHasLiked:null==(t=e.data.data)?void 0:t.user_has_liked}),e.data}catch(e){throw console.error("❌ Like Service: Failed to unlike post:",{postId:n,error:(null==(o=e.response)?void 0:o.data)||e.message}),(null==(i=e.response)?void 0:i.status)===400&&(null==(s=e.response)||null==(r=s.data)||null==(l=r.message)?void 0:l.includes("not liked"))&&console.warn("⚠️ Like Service: Post not liked by user"),e}},async togglePostLike(e){var a,t,o,i,l;let{postId:r}=e;console.log("\uD83D\uDCE1 Like Service: Toggling like for post:",r);try{try{return await this.likePost({postId:r})}catch(e){if((null==(a=e.response)?void 0:a.status)===400&&(null==(i=e.response)||null==(o=i.data)||null==(t=o.message)?void 0:t.includes("already liked")))return await this.unlikePost({postId:r});throw e}}catch(e){throw console.error("❌ Like Service: Failed to toggle post like:",{postId:r,error:(null==(l=e.response)?void 0:l.data)||e.message}),e}}},F=(0,s.zD)("likes/getPostLikes",async(e,a)=>{let{postId:t}=e,{rejectWithValue:o}=a;try{console.log("\uD83D\uDD04 Like Slice: Getting likes for post:",t);let e=await v.getPostLikes({postId:t}),a={likes:e.data.likes,like_count:e.data.like_count,user_has_liked:e.data.user_has_liked,postId:t};return console.log("✅ Like Slice: Got post likes successfully:",{postId:t,likeCount:a.like_count,userHasLiked:a.user_has_liked}),{postId:t,likeData:a}}catch(e){var i,l;return console.error("❌ Like Slice: Failed to get post likes:",e),o((null==(l=e.response)||null==(i=l.data)?void 0:i.message)||e.message||"Failed to get post likes")}}),C=(0,s.zD)("likes/likePost",async(e,a)=>{let{postId:t}=e,{rejectWithValue:o}=a;try{console.log("\uD83D\uDD04 Like Slice: Liking post:",t);let e=await v.likePost({postId:t});return console.log("✅ Like Slice: Liked post successfully:",{postId:t,likeCount:e.data.like_count,userHasLiked:e.data.user_has_liked}),{postId:t,likeCount:e.data.like_count,userHasLiked:e.data.user_has_liked}}catch(e){var i,l;return console.error("❌ Like Slice: Failed to like post:",e),o((null==(l=e.response)||null==(i=l.data)?void 0:i.message)||e.message||"Failed to like post")}}),L=(0,s.zD)("likes/unlikePost",async(e,a)=>{let{postId:t}=e,{rejectWithValue:o}=a;try{console.log("\uD83D\uDD04 Like Slice: Unliking post:",t);let e=await v.unlikePost({postId:t});return console.log("✅ Like Slice: Unliked post successfully:",{postId:t,likeCount:e.data.like_count,userHasLiked:e.data.user_has_liked}),{postId:t,likeCount:e.data.like_count,userHasLiked:e.data.user_has_liked}}catch(e){var i,l;return console.error("❌ Like Slice: Failed to unlike post:",e),o((null==(l=e.response)||null==(i=l.data)?void 0:i.message)||e.message||"Failed to unlike post")}}),w=(0,s.zD)("likes/togglePostLike",async(e,a)=>{let{postId:t}=e,{rejectWithValue:o}=a;try{console.log("\uD83D\uDD04 Like Slice: Toggling like for post:",t);let e=await v.togglePostLike({postId:t});return console.log("✅ Like Slice: Toggled post like successfully:",{postId:t,likeCount:e.data.like_count,userHasLiked:e.data.user_has_liked}),{postId:t,likeCount:e.data.like_count,userHasLiked:e.data.user_has_liked}}catch(e){var i,l;return console.error("❌ Like Slice: Failed to toggle post like:",e),o((null==(l=e.response)||null==(i=l.data)?void 0:i.message)||e.message||"Failed to toggle like")}}),S=(0,s.Z0)({name:"likes",initialState:{postLikes:{},isLoading:!1,isToggling:!1,error:null},reducers:{clearLikeError:e=>{e.error=null},clearPostLikes:(e,a)=>{let t=a.payload;delete e.postLikes[t]},clearAllLikes:e=>{e.postLikes={},e.error=null}},extraReducers:e=>{e.addCase(F.pending,e=>{e.isLoading=!0,e.error=null}).addCase(F.fulfilled,(e,a)=>{e.isLoading=!1,e.error=null;let{postId:t,likeData:o}=a.payload;e.postLikes[t]=o}).addCase(F.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload||"Failed to get post likes"}).addCase(C.pending,e=>{e.isToggling=!0,e.error=null}).addCase(C.fulfilled,e=>{e.isToggling=!1,e.error=null}).addCase(C.rejected,(e,a)=>{e.isToggling=!1,e.error=a.payload||"Failed to like post"}).addCase(L.pending,e=>{e.isToggling=!0,e.error=null}).addCase(L.fulfilled,e=>{e.isToggling=!1,e.error=null}).addCase(L.rejected,(e,a)=>{e.isToggling=!1,e.error=a.payload||"Failed to unlike post"}).addCase(w.pending,e=>{e.isToggling=!0,e.error=null}).addCase(w.fulfilled,(e,a)=>{let{payload:t}=a;e.isToggling=!1,e.error=null;let{postId:o,likeCount:i,userHasLiked:l}=t;e.postLikes[o]?(e.postLikes[o].like_count=i,e.postLikes[o].user_has_liked=l):e.postLikes[o]={likes:[],like_count:i,user_has_liked:l,postId:o}}).addCase(w.rejected,(e,a)=>{let{payload:t}=a;e.isToggling=!1,e.error=t||"Failed to toggle like"})}}),{clearLikeError:A,clearPostLikes:q,clearAllLikes:P}=S.actions,R=S.reducer,T={key:"auth",storage:d.A,whitelist:["token","user","isAuthenticated"]},j=(0,c.HY)({auth:(0,n.rL)(T,u.Ay),posts:g.Ay,comments:p.Ay,notifications:k.Ay,messages:f.Ay,faqs:y.Ay,admin:h.Ay,tags:_.Ay,likes:R}),z=(0,s.U1)({reducer:j,middleware:e=>e({serializableCheck:{ignoredActions:["persist/PERSIST","persist/REHYDRATE","persist/PAUSE","persist/PERSIST","persist/PURGE","persist/REGISTER"]}}),devTools:!1}),x=(0,n.GM)(z);function D(e){let{children:a}=e;return console.log("\uD83D\uDD04 Store Provider: Initializing Redux store with persistence"),(0,i.useEffect)(()=>{console.log("\uD83D\uDD04 Store Provider: Setting up enhanced token initialization after mount"),(0,m.sw)();let e=z.subscribe(()=>{let e=z.getState().auth;e&&"token"in e&&e.token&&(console.log("\uD83D\uDD04 Store Provider: Auth state changed, reinitializing token"),setTimeout(()=>{(0,m.sw)()},50))}),a=setTimeout(()=>{console.log("\uD83D\uDD04 Store Provider: Delayed token initialization for HMR compatibility"),(0,m.sw)()},200);return()=>{e(),clearTimeout(a)}},[]),(0,o.jsx)(l.Kq,{store:z,children:(0,o.jsx)(r.Q,{loading:(0,o.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,o.jsx)("div",{className:"text-lg",children:"Loading..."})}),persistor:x,onBeforeLift:()=>{console.log("✅ Store Provider: Redux state rehydrated from persistence"),setTimeout(()=>{console.log("\uD83D\uDD04 Store Provider: Post-rehydration token initialization"),(0,m.sw)()},0),setTimeout(()=>{console.log("\uD83D\uDD04 Store Provider: Extended post-rehydration token initialization"),(0,m.sw)()},100)},children:a})})}(0,m.sw)()}},e=>{var a=a=>e(e.s=a);e.O(0,[7690,3863,3157,8185,6048,4287,8441,1684,7358],()=>a(29750)),_N_E=e.O()}]);